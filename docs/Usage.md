# Usage Guide

The **VBA Compile Simulator** is a command-line tool designed to statically analyze VBA code exported from Microsoft Office applications. It simulates the compilation process to detect syntax errors, undefined variables, and type mismatches without requiring the Windows environment.

## Installation

### Prerequisites
- Python 3.8 or higher
- Pip (Python Package Manager)

### Setup
1. Clone the repository:
   ```bash
   git clone https://github.com/your-repo/vba-compile-simulator.git
   cd vba-compile-simulator
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Running the Tool

The tool is executed via the `src.main` module.

```bash
python3 -m src.main <input_folder> [options]
```

### Arguments

| Argument | Description |
| :--- | :--- |
| `input_folder` | **Required.** Path to the directory containing your exported `.bas`, `.cls`, and `.frm` files. |
| `--define` | Conditional Compilation constants. Format: `KEY=VALUE,KEY2=True`. |
| `--model` | Path to a custom JSON Object Model file. |
| `--output` | Path to save the structured JSON report (default: `vba_report.json`). |

### Examples

#### Basic Check
Check all files in the `export` folder using standard Excel definitions.
```bash
python3 -m src.main ./export
```

#### Conditional Compilation
Simulate a 64-bit environment where `#If Win64 Then` blocks are active.
```bash
python3 -m src.main ./export --define "Win64=True,VBA7=True"
```

#### Custom Object Model
Use a specific object model definition (e.g., for Word or Outlook) generated by the exporter.
```bash
python3 -m src.main ./export --model ./word_model.json
```

## Output

The tool provides two types of output:

1.  **Console Output:** Colored logs indicating the file, line number, and error message.
    ```
    Module1.bas:10: Undefined identifier 'MyVar' in 'MySub'.
    ```

2.  **JSON Report:** A machine-readable report saved to the specified output path.
    ```json
    {
      "summary": {
        "files_scanned": 5,
        "issues_found": 1
      },
      "issues": [
        {
          "file": "Module1.bas",
          "line": 10,
          "message": "Undefined identifier 'MyVar' in 'MySub'."
        }
      ]
    }
    ```
