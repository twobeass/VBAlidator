# Usage Guide

**VBAlidator** is a command-line tool designed to statically analyze VBA code exported from Microsoft Office applications. It simulates the compilation process to detect syntax errors, undefined variables, and type mismatches without requiring the Windows environment.

## Installation

### Prerequisites
- Python 3.8 or higher
- Pip (Python Package Manager)

### Setup
1. Clone the repository:
   ```bash
   git clone https://github.com/twobeass/VBAlidator.git
   cd VBAlidator
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Running the Tool

VBAlidator is executed as a Python module.

```bash
python -m src.main [options] <input_folder>
```

### Arguments

| Argument | Description |
| :--- | :--- |
| `input_folder` | **Required.** Positional argument. Path to the directory containing your exported `.bas`, `.cls`, and `.frm` files. |
| `-h, --help` | Show help message and exit. |
| `--define` | Conditional Compilation constants. Format: `KEY=VALUE,KEY2=True`. |
| `--model` | Path to a custom JSON Object Model file. Merges with the standard library. |
| `--output` | Path to save the structured JSON report (default: `vba_report.json`). |

### Examples

#### Basic Check
Check all files in the `export` folder.
```bash
python -m src.main ./export
```

#### Conditional Compilation
Simulate a 64-bit environment.
```bash
python -m src.main ./export --define "Win64=True,VBA7=True"
```

#### Custom Object Model
Use a specific object model definition generated by the exporter.
```bash
python -m src.main ./export --model ./vba_model.json
```

## Output

The tool provides two types of output:

1.  **Console Output:** Colored logs indicating the file, line number, and error message.
    ```
    Module1.bas:10: Undefined identifier 'MyVar' in 'MySub'.
    ```

2.  **JSON Report:** A machine-readable report saved to the specified output path.
    ```json
    {
      "summary": {
        "files_scanned": 5,
        "issues_found": 1
      },
      "issues": [
        {
          "file": "Module1.bas",
          "line": 10,
          "message": "Undefined identifier 'MyVar' in 'MySub'."
        }
      ]
    }
    ```
